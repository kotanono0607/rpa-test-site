<!-- levels.html - ãƒ¬ãƒ™ãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ®µéšçš„å­¦ç¿’ï¼‰ãƒšãƒ¼ã‚¸ Ver.1.0 -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒ¬ãƒ™ãƒ«ãƒ¢ãƒ¼ãƒ‰ - RPA ãƒ†ã‚¹ãƒˆã‚µã‚¤ãƒˆ</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    .level-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .level-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border: 3px solid var(--border);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }
    .level-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .level-card.locked {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .level-card.cleared {
      border-color: var(--success);
      background: linear-gradient(135deg, #f0fdf4, #dcfce7);
    }
    .level-card.current {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2);
    }
    .level-number {
      position: absolute;
      top: -12px;
      left: -12px;
      width: 40px;
      height: 40px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
    }
    .level-card.cleared .level-number {
      background: var(--success);
    }
    .level-card.locked .level-number {
      background: var(--secondary);
    }
    .level-title {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 8px;
      padding-left: 20px;
    }
    .level-desc {
      color: var(--secondary);
      font-size: 0.9rem;
      margin-bottom: 12px;
    }
    .level-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
    }
    .level-status .stars {
      color: #fbbf24;
    }
    .level-status .locked-text {
      color: var(--secondary);
    }
    .level-status .cleared-text {
      color: var(--success);
      font-weight: bold;
    }
    .level-arena {
      background: white;
      border-radius: 12px;
      padding: 24px;
      min-height: 400px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .level-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--border);
    }
    .level-header h2 {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .level-header .level-badge {
      background: var(--primary);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
    }
    .mission-box {
      background: linear-gradient(135deg, #eff6ff, #dbeafe);
      padding: 16px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      border-left: 4px solid var(--primary);
    }
    .mission-box h3 {
      margin-bottom: 8px;
      color: var(--primary);
    }
    .level-content {
      padding: 20px;
      background: var(--light);
      border-radius: 8px;
      min-height: 200px;
    }
    .level-actions {
      margin-top: 20px;
      display: flex;
      gap: 12px;
      justify-content: center;
    }
    .progress-bar-container {
      background: var(--border);
      border-radius: 10px;
      height: 20px;
      overflow: hidden;
      margin-bottom: 24px;
    }
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--success), #34d399);
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.75rem;
      font-weight: bold;
    }
    .celebration {
      text-align: center;
      padding: 40px;
      animation: celebrate 0.5s ease;
    }
    @keyframes celebrate {
      0% { transform: scale(0.8); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    .celebration h2 {
      font-size: 2rem;
      color: var(--success);
      margin-bottom: 16px;
    }
    .celebration .stars {
      font-size: 3rem;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <a href="index.html" class="logo">RPA ãƒ†ã‚¹ãƒˆã‚µã‚¤ãƒˆ</a>
      <nav>
        <ul>
          <li><a href="index.html">ãƒˆãƒƒãƒ—</a></li>
          <li><a href="form.html">å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ </a></li>
          <li><a href="click.html">ã‚¯ãƒªãƒƒã‚¯</a></li>
          <li><a href="keyboard.html">ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰</a></li>
          <li><a href="wait.html">å¾…æ©Ÿ</a></li>
          <li><a href="table.html">ãƒ†ãƒ¼ãƒ–ãƒ«</a></li>
          <li><a href="popup.html">ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—</a></li>
          <li><a href="dynamic.html">å‹•çš„</a></li>
          <li><a href="advanced.html">é«˜åº¦</a></li>
          <li><a href="challenge.html">æŒ‘æˆ¦</a></li>
          <li><a href="levels.html" class="active">ãƒ¬ãƒ™ãƒ«</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <h1 class="page-title">ğŸ® ãƒ¬ãƒ™ãƒ«ãƒ¢ãƒ¼ãƒ‰</h1>
      <p class="page-description">ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§RPAæ“ä½œã‚’å­¦ã¼ã†ï¼å„ãƒ¬ãƒ™ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¦æ¬¡ã«é€²ã‚‚ã†ã€‚</p>

      <!-- é€²æ—ãƒãƒ¼ -->
      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="total-progress" style="width: 0%;">0%</div>
      </div>

      <!-- ãƒ¬ãƒ™ãƒ«ä¸€è¦§ -->
      <div class="level-grid" id="level-grid">
        <!-- JavaScriptã§ç”Ÿæˆ -->
      </div>

      <!-- ãƒ¬ãƒ™ãƒ«ãƒ—ãƒ¬ã‚¤ã‚¨ãƒªã‚¢ -->
      <div class="level-arena" id="level-arena">
        <div style="text-align: center; padding: 60px; color: var(--secondary);">
          <p style="font-size: 1.2rem;">ä¸Šã‹ã‚‰ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        </div>
      </div>

      <!-- æ“ä½œãƒ­ã‚° -->
      <div class="card" style="margin-top: 24px;">
        <div class="card-title">ğŸ“œ æ“ä½œãƒ­ã‚°</div>
        <div id="level-log" class="log-area">
          <div class="log-entry"><span class="log-time">[--:--:--]</span>ãƒ¬ãƒ™ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¸ã‚ˆã†ã“ãï¼</div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <p>RPA Test Site for UIpowershell - Created for automation testing</p>
  </footer>

  <script src="script.js"></script>
  <script>
    // ãƒ¬ãƒ™ãƒ«ãƒ‡ãƒ¼ã‚¿
    const levels = [
      {
        id: 1,
        title: 'ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯',
        desc: 'ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã¿ã‚ˆã†',
        mission: 'ã€Œã‚¯ãƒªãƒƒã‚¯ï¼ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„',
        type: 'click'
      },
      {
        id: 2,
        title: 'ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›',
        desc: 'å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ–‡å­—ã‚’å…¥åŠ›ã—ã‚ˆã†',
        mission: 'å…¥åŠ›æ¬„ã«ã€ŒRPAã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„',
        type: 'input',
        answer: 'RPA'
      },
      {
        id: 3,
        title: 'ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³é¸æŠ',
        desc: 'ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰é¸æŠã—ã‚ˆã†',
        mission: 'ã€Œæ±äº¬éƒ½ã€ã‚’é¸æŠã—ã¦ãã ã•ã„',
        type: 'select',
        answer: 'tokyo'
      },
      {
        id: 4,
        title: 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹',
        desc: 'ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ONã«ã—ã‚ˆã†',
        mission: 'ã€ŒåŒæ„ã™ã‚‹ã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„',
        type: 'checkbox'
      },
      {
        id: 5,
        title: 'ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³',
        desc: 'é¸æŠè‚¢ã‹ã‚‰1ã¤é¸ã¼ã†',
        mission: 'ã€Œã‚ªãƒ—ã‚·ãƒ§ãƒ³Bã€ã‚’é¸æŠã—ã¦ãã ã•ã„',
        type: 'radio',
        answer: 'b'
      },
      {
        id: 6,
        title: 'é€£ç¶šã‚¯ãƒªãƒƒã‚¯',
        desc: 'æŒ‡å®šã•ã‚ŒãŸé †ç•ªã§ã‚¯ãƒªãƒƒã‚¯ã—ã‚ˆã†',
        mission: 'ãƒœã‚¿ãƒ³ã‚’1â†’2â†’3ã®é †ã«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„',
        type: 'sequence'
      },
      {
        id: 7,
        title: 'ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›',
        desc: 'è¤‡æ•°ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å…¥åŠ›ã—ã‚ˆã†',
        mission: 'åå‰ã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„',
        type: 'form'
      },
      {
        id: 8,
        title: 'ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œ',
        desc: 'ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ç‰¹å®šã®è¡Œã‚’é¸æŠã—ã‚ˆã†',
        mission: 'ã€Œã‚Šã‚“ã”ã€ã®è¡Œã®ã€Œé¸æŠã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„',
        type: 'table'
      },
      {
        id: 9,
        title: 'å¾…æ©Ÿã—ã¦æ“ä½œ',
        desc: 'è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã£ã¦ã‹ã‚‰æ“ä½œã—ã‚ˆã†',
        mission: 'ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼ˆ2ç§’å¾Œã«è¡¨ç¤ºï¼‰',
        type: 'wait'
      },
      {
        id: 10,
        title: 'ç·åˆãƒ†ã‚¹ãƒˆ',
        desc: 'ã™ã¹ã¦ã®ã‚¹ã‚­ãƒ«ã‚’ä½¿ãŠã†',
        mission: 'å…¥åŠ›â†’é¸æŠâ†’ãƒã‚§ãƒƒã‚¯â†’é€ä¿¡ã®é †ã«æ“ä½œã—ã¦ãã ã•ã„',
        type: 'final'
      }
    ];

    // ã‚¯ãƒªã‚¢çŠ¶æ…‹ã‚’ç®¡ç†
    let clearedLevels = JSON.parse(localStorage.getItem('rpa-cleared-levels') || '[]');
    let currentLevel = null;

    // ãƒ¬ãƒ™ãƒ«ä¸€è¦§ã‚’æç”»
    function renderLevelGrid() {
      const grid = document.getElementById('level-grid');
      grid.innerHTML = levels.map((level, index) => {
        const isCleared = clearedLevels.includes(level.id);
        const isLocked = index > 0 && !clearedLevels.includes(levels[index - 1].id);
        const isCurrent = !isCleared && !isLocked;

        let statusHtml = '';
        if (isCleared) {
          statusHtml = '<span class="cleared-text">âœ… ã‚¯ãƒªã‚¢æ¸ˆã¿</span><span class="stars">â­â­â­</span>';
        } else if (isLocked) {
          statusHtml = '<span class="locked-text">ğŸ”’ å‰ã®ãƒ¬ãƒ™ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„</span>';
        } else {
          statusHtml = '<span style="color: var(--primary);">â–¶ æŒ‘æˆ¦å¯èƒ½</span>';
        }

        return `
          <div class="level-card ${isCleared ? 'cleared' : ''} ${isLocked ? 'locked' : ''} ${isCurrent ? 'current' : ''}"
               onclick="${isLocked ? '' : `startLevel(${level.id})`}">
            <div class="level-number">${level.id}</div>
            <div class="level-title">${level.title}</div>
            <div class="level-desc">${level.desc}</div>
            <div class="level-status">${statusHtml}</div>
          </div>
        `;
      }).join('');

      // é€²æ—ãƒãƒ¼ã‚’æ›´æ–°
      const progress = (clearedLevels.length / levels.length) * 100;
      document.getElementById('total-progress').style.width = progress + '%';
      document.getElementById('total-progress').textContent = Math.round(progress) + '%';
    }

    // ãƒ¬ãƒ™ãƒ«ã‚’é–‹å§‹
    function startLevel(levelId) {
      const level = levels.find(l => l.id === levelId);
      if (!level) return;

      currentLevel = level;
      ãƒ­ã‚°ã‚’è¿½åŠ ('level-log', `ãƒ¬ãƒ™ãƒ«${level.id}ã€Œ${level.title}ã€ã‚’é–‹å§‹`);

      const arena = document.getElementById('level-arena');
      arena.innerHTML = `
        <div class="level-header">
          <h2><span class="level-badge">Level ${level.id}</span> ${level.title}</h2>
          <button class="btn btn-secondary" onclick="renderLevelGrid(); resetArena();">æˆ»ã‚‹</button>
        </div>
        <div class="mission-box">
          <h3>ğŸ“‹ ãƒŸãƒƒã‚·ãƒ§ãƒ³</h3>
          <p>${level.mission}</p>
        </div>
        <div class="level-content" id="level-content">
          ${getLevelContent(level)}
        </div>
      `;
    }

    // ãƒ¬ãƒ™ãƒ«ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆ
    function getLevelContent(level) {
      switch (level.type) {
        case 'click':
          return `
            <div style="text-align: center; padding: 40px;">
              <button class="btn btn-primary" style="font-size: 1.5rem; padding: 20px 60px;"
                      onclick="checkAnswer('click')">ã‚¯ãƒªãƒƒã‚¯ï¼</button>
            </div>
          `;

        case 'input':
          return `
            <div style="max-width: 400px; margin: 0 auto; padding: 40px;">
              <div class="form-group">
                <label>ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›:</label>
                <input type="text" id="level-input" placeholder="ã“ã“ã«å…¥åŠ›...">
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('input')">ç¢ºèª</button>
            </div>
          `;

        case 'select':
          return `
            <div style="max-width: 400px; margin: 0 auto; padding: 40px;">
              <div class="form-group">
                <label>éƒ½é“åºœçœŒã‚’é¸æŠ:</label>
                <select id="level-select">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="hokkaido">åŒ—æµ·é“</option>
                  <option value="tokyo">æ±äº¬éƒ½</option>
                  <option value="osaka">å¤§é˜ªåºœ</option>
                  <option value="fukuoka">ç¦å²¡çœŒ</option>
                </select>
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('select')">ç¢ºèª</button>
            </div>
          `;

        case 'checkbox':
          return `
            <div style="max-width: 400px; margin: 0 auto; padding: 40px;">
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                  <input type="checkbox" id="level-checkbox" style="width: 24px; height: 24px;">
                  <span style="font-size: 1.1rem;">åŒæ„ã™ã‚‹</span>
                </label>
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('checkbox')">ç¢ºèª</button>
            </div>
          `;

        case 'radio':
          return `
            <div style="max-width: 400px; margin: 0 auto; padding: 40px;">
              <div class="form-group">
                <label>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠ:</label>
                <div class="radio-group" style="margin-top: 12px;">
                  <label style="display: block; margin: 8px 0; cursor: pointer;">
                    <input type="radio" name="level-radio" value="a"> ã‚ªãƒ—ã‚·ãƒ§ãƒ³A
                  </label>
                  <label style="display: block; margin: 8px 0; cursor: pointer;">
                    <input type="radio" name="level-radio" value="b"> ã‚ªãƒ—ã‚·ãƒ§ãƒ³B
                  </label>
                  <label style="display: block; margin: 8px 0; cursor: pointer;">
                    <input type="radio" name="level-radio" value="c"> ã‚ªãƒ—ã‚·ãƒ§ãƒ³C
                  </label>
                </div>
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('radio')">ç¢ºèª</button>
            </div>
          `;

        case 'sequence':
          return `
            <div style="text-align: center; padding: 40px;">
              <p style="margin-bottom: 20px;">é€²æ—: <span id="seq-progress">0</span>/3</p>
              <div style="display: flex; gap: 16px; justify-content: center;">
                <button class="btn btn-secondary" style="font-size: 1.3rem; padding: 15px 30px;"
                        onclick="checkSequence(1)" id="seq-btn-1">1</button>
                <button class="btn btn-secondary" style="font-size: 1.3rem; padding: 15px 30px;"
                        onclick="checkSequence(2)" id="seq-btn-2">2</button>
                <button class="btn btn-secondary" style="font-size: 1.3rem; padding: 15px 30px;"
                        onclick="checkSequence(3)" id="seq-btn-3">3</button>
              </div>
            </div>
          `;

        case 'form':
          return `
            <div style="max-width: 400px; margin: 0 auto; padding: 20px;">
              <div class="form-group">
                <label>åå‰:</label>
                <input type="text" id="form-name" placeholder="åå‰ã‚’å…¥åŠ›">
              </div>
              <div class="form-group">
                <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</label>
                <input type="email" id="form-email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚’å…¥åŠ›">
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('form')">é€ä¿¡</button>
            </div>
          `;

        case 'table':
          return `
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>ID</th><th>å•†å“å</th><th>æ“ä½œ</th></tr>
                </thead>
                <tbody>
                  <tr><td>001</td><td>ã‚Šã‚“ã”</td><td><button class="btn btn-primary" onclick="checkAnswer('table', 'ã‚Šã‚“ã”')">é¸æŠ</button></td></tr>
                  <tr><td>002</td><td>ã¿ã‹ã‚“</td><td><button class="btn btn-secondary" onclick="checkAnswer('table', 'ã¿ã‹ã‚“')">é¸æŠ</button></td></tr>
                  <tr><td>003</td><td>ã¶ã©ã†</td><td><button class="btn btn-secondary" onclick="checkAnswer('table', 'ã¶ã©ã†')">é¸æŠ</button></td></tr>
                </tbody>
              </table>
            </div>
          `;

        case 'wait':
          setTimeout(() => {
            const container = document.getElementById('wait-btn-container');
            if (container) {
              container.innerHTML = '<button class="btn btn-success" style="font-size: 1.2rem;" onclick="checkAnswer(\'wait\')">ä»Šã ï¼ã‚¯ãƒªãƒƒã‚¯ï¼</button>';
            }
          }, 2000);
          return `
            <div style="text-align: center; padding: 40px;">
              <p style="margin-bottom: 20px;">ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã£ã¦ãã ã•ã„...</p>
              <div id="wait-btn-container">
                <div class="spinner"></div>
              </div>
            </div>
          `;

        case 'final':
          return `
            <div style="max-width: 500px; margin: 0 auto; padding: 20px;">
              <div class="form-group">
                <label>1. åå‰ã‚’å…¥åŠ›:</label>
                <input type="text" id="final-name" placeholder="åå‰">
              </div>
              <div class="form-group">
                <label>2. ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠ:</label>
                <select id="final-select">
                  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                  <option value="a">ã‚«ãƒ†ã‚´ãƒªA</option>
                  <option value="b">ã‚«ãƒ†ã‚´ãƒªB</option>
                </select>
              </div>
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                  <input type="checkbox" id="final-check">
                  <span>3. ç¢ºèªã—ã¾ã—ãŸ</span>
                </label>
              </div>
              <button class="btn btn-primary" onclick="checkAnswer('final')">4. é€ä¿¡</button>
            </div>
          `;

        default:
          return '<p>Coming soon...</p>';
      }
    }

    // å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯
    let sequenceProgress = 0;

    function checkAnswer(type, extra) {
      let success = false;

      switch (type) {
        case 'click':
          success = true;
          break;

        case 'input':
          const inputVal = document.getElementById('level-input').value;
          success = inputVal.toUpperCase() === currentLevel.answer;
          break;

        case 'select':
          const selectVal = document.getElementById('level-select').value;
          success = selectVal === currentLevel.answer;
          break;

        case 'checkbox':
          success = document.getElementById('level-checkbox').checked;
          break;

        case 'radio':
          const radioVal = document.querySelector('input[name="level-radio"]:checked')?.value;
          success = radioVal === currentLevel.answer;
          break;

        case 'form':
          const name = document.getElementById('form-name').value;
          const email = document.getElementById('form-email').value;
          success = name.length > 0 && email.includes('@');
          break;

        case 'table':
          success = extra === 'ã‚Šã‚“ã”';
          break;

        case 'wait':
          success = true;
          break;

        case 'final':
          const fName = document.getElementById('final-name').value;
          const fSelect = document.getElementById('final-select').value;
          const fCheck = document.getElementById('final-check').checked;
          success = fName.length > 0 && fSelect && fCheck;
          break;
      }

      if (success) {
        clearLevel();
      } else {
        ãƒ­ã‚°ã‚’è¿½åŠ ('level-log', 'âŒ æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã›ã‚“ã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚');
        alert('æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã›ã‚“ã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚');
      }
    }

    function checkSequence(num) {
      const expected = sequenceProgress + 1;
      if (num === expected) {
        sequenceProgress++;
        document.getElementById('seq-progress').textContent = sequenceProgress;
        document.getElementById(`seq-btn-${num}`).classList.add('btn-success');
        document.getElementById(`seq-btn-${num}`).classList.remove('btn-secondary');

        if (sequenceProgress === 3) {
          setTimeout(() => clearLevel(), 300);
        }
      } else {
        sequenceProgress = 0;
        document.getElementById('seq-progress').textContent = '0';
        [1, 2, 3].forEach(n => {
          document.getElementById(`seq-btn-${n}`).classList.remove('btn-success');
          document.getElementById(`seq-btn-${n}`).classList.add('btn-secondary');
        });
        ãƒ­ã‚°ã‚’è¿½åŠ ('level-log', 'âŒ é †ç•ªãŒé•ã„ã¾ã™ã€‚1ã‹ã‚‰ã‚„ã‚Šç›´ã—ã¦ãã ã•ã„ã€‚');
      }
    }

    // ãƒ¬ãƒ™ãƒ«ã‚¯ãƒªã‚¢
    function clearLevel() {
      if (!clearedLevels.includes(currentLevel.id)) {
        clearedLevels.push(currentLevel.id);
        localStorage.setItem('rpa-cleared-levels', JSON.stringify(clearedLevels));
      }

      ãƒ­ã‚°ã‚’è¿½åŠ ('level-log', `ğŸ‰ ãƒ¬ãƒ™ãƒ«${currentLevel.id}ã€Œ${currentLevel.title}ã€ã‚¯ãƒªã‚¢ï¼`);

      const arena = document.getElementById('level-arena');
      arena.innerHTML = `
        <div class="celebration">
          <div class="stars">â­â­â­</div>
          <h2>ğŸ‰ ãƒ¬ãƒ™ãƒ«${currentLevel.id} ã‚¯ãƒªã‚¢ï¼</h2>
          <p style="font-size: 1.2rem; margin-bottom: 24px;">${currentLevel.title}ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ãŸï¼</p>
          <div class="level-actions">
            ${currentLevel.id < levels.length
              ? `<button class="btn btn-primary" onclick="startLevel(${currentLevel.id + 1})">æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ â†’</button>`
              : `<button class="btn btn-success" onclick="alert('ãŠã‚ã§ã¨ã†ï¼å…¨ãƒ¬ãƒ™ãƒ«ã‚¯ãƒªã‚¢ï¼')">ğŸ† å…¨ã‚¯ãƒªã‚¢ï¼</button>`
            }
            <button class="btn btn-secondary" onclick="renderLevelGrid(); resetArena();">ãƒ¬ãƒ™ãƒ«é¸æŠã«æˆ»ã‚‹</button>
          </div>
        </div>
      `;

      renderLevelGrid();
    }

    // ã‚¢ãƒªãƒ¼ãƒŠã‚’ãƒªã‚»ãƒƒãƒˆ
    function resetArena() {
      sequenceProgress = 0;
      document.getElementById('level-arena').innerHTML = `
        <div style="text-align: center; padding: 60px; color: var(--secondary);">
          <p style="font-size: 1.2rem;">ä¸Šã‹ã‚‰ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        </div>
      `;
    }

    // é€²æ—ãƒªã‚»ãƒƒãƒˆ
    function resetProgress() {
      if (confirm('é€²æ—ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
        clearedLevels = [];
        localStorage.removeItem('rpa-cleared-levels');
        renderLevelGrid();
        resetArena();
        ãƒ­ã‚°ã‚’è¿½åŠ ('level-log', 'é€²æ—ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸ');
      }
    }

    // åˆæœŸåŒ–
    renderLevelGrid();
  </script>
</body>
</html>
